{{- if and .Values.deployArgo .Values.argoInstance.password }}
apiVersion: v1
kind: Secret
metadata:
  name: argocd-secret
  namespace: {{ .Release.Namespace }}
data:
  # NOTE: Helm cannot easily bcrypt. We assume the password provided in values is ALREADY bcrypted 
  # OR we use a simple base64 if the application supports it (ArgoCD usually expects bcrypt in the secret).
  # If the upstream argocd-operator expects a secret with 'admin.password', it typically wants a bcrypt hash.
  # For this refactor, we will assume the passed value is compatible.
  admin.password: {{ .Values.argoInstance.password | b64enc | quote }}
  admin.passwordMtime: {{ now | date "2006-01-02T15:04:05Z" | b64enc | quote }}
type: Opaque
{{- end }}
